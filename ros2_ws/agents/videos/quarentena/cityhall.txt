Script started on 2025-06-28 14:38:07+01:00 [TERM="xterm-256color" TTY="/dev/pts/3" COLUMNS="173" LINES="36"]
[1m[7m%[27m[1m[0m                                                                                                                                                                             ]2;rafaelbranco@fedora:~/Documentos/ISEP/OmniWatch/ros2_ws/agents]1;..os2_ws/agents]7;file://fedora/home/rafaelbranco/Documentos/ISEP/OmniWatch/ros2_ws/agents\[0m[27m[24m[J[39m[0m[49m[40m[39m rafaelbranco@fedora [44m[30m[30m ~/Documentos/ISEP/OmniWatch/ros2_ws/agents [43m[34m[30m  main ± [49m[33m[39m [K[?1h=[?2004h[1m[31mp[0m[39m[1m[31mp[0m[39m[90mython3 run_zone_manager.py[39m[26D[1m[31mp[1m[31my[0m[39m[1m[31mp[1m[31my[1m[31mt[0m[39m[1m[31mt[1m[31mh[0m[39m[1m[31mh[1m[31mo[0m[39m[1m[31mo[1m[31mn[0m[39m[0m[32mp[0m[32my[0m[32mt[0m[32mh[0m[32mo[0m[32mn[32m3[39m[39m [39m[4mc[24m[39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [39m [18D[90mityHall.py[39m[10D[4mc[39m[4mi[24m[4mi[39m[4mt[39m[4my[39m[4mH[39m[4ma[39m[4ml[39m[4ml[39m[4m.[39m[4mp[39m[4my[24m[?1l>[?2004l
]2;python3 cityHall.py]1;python3[CityHall] 🏛️ Loading model...
/usr/lib/python3.10/pickle.py:1718: UserWarning: [14:38:32] WARNING: /workspace/src/collective/../data/../common/error_msg.h:82: If you are loading a serialized model (like pickle in Python, RDS in R) or
configuration generated by an older version of XGBoost, please export the model by calling
`Booster.save_model` from that version first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/stable/tutorials/saving_model.html

for more details about differences between saving model and serializing.

  setstate(state)
[CityHall] 🟢 City Hall Agent is up and running.
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] 📩 Received log from car_1
[2025-06-28T14:38:37.375580][CityHall] 🔍 Prediction for car_1: DDoS-HOIC
[CityHall] 🚨 Malicious activity detected from car_1, broadcasting to zones...
[CityHall] 🔔 Notified zone_1@localhost about threat from car_1
[CityHall] 🔔 Notified zone_2@localhost about threat from car_1
[CityHall] 🔔 Notified zone_3@localhost about threat from car_1
[CityHall] 🔔 Notified zone_4@localhost about threat from car_1
[CityHall] 📩 Received log from car_2
[2025-06-28T14:38:38.391368][CityHall] 🔍 Prediction for car_2: DDoS-HOIC
[CityHall] 🚨 Malicious activity detected from car_2, broadcasting to zones...
[CityHall] 🔔 Notified zone_1@localhost about threat from car_2
[CityHall] 🔔 Notified zone_2@localhost about threat from car_2
[CityHall] 🔔 Notified zone_3@localhost about threat from car_2
[CityHall] 🔔 Notified zone_4@localhost about threat from car_2
[CityHall] 📩 Received log from car_3
[2025-06-28T14:38:39.368208][CityHall] 🔍 Prediction for car_3: Benign
[CityHall] ✅ Log from car_3 considered benign.
[CityHall] 📩 Received log from car_4
[2025-06-28T14:38:40.381653][CityHall] 🔍 Prediction for car_4: Benign
[CityHall] ✅ Log from car_4 considered benign.
[CityHall] 📩 Received log from car_5
[2025-06-28T14:38:41.373372][CityHall] 🔍 Prediction for car_5: Benign
[CityHall] ✅ Log from car_5 considered benign.
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] 📩 Received log from car_1
[2025-06-28T14:39:07.388587][CityHall] 🔍 Prediction for car_1: Benign
[CityHall] ✅ Log from car_1 considered benign.
[CityHall] 📩 Received log from car_2
[2025-06-28T14:39:08.379623][CityHall] 🔍 Prediction for car_2: Benign
[CityHall] ✅ Log from car_2 considered benign.
[CityHall] 📩 Received log from car_3
[2025-06-28T14:39:09.370599][CityHall] 🔍 Prediction for car_3: Benign
[CityHall] ✅ Log from car_3 considered benign.
[CityHall] 📩 Received log from car_4
[2025-06-28T14:39:10.374267][CityHall] 🔍 Prediction for car_4: Benign
[CityHall] ✅ Log from car_4 considered benign.
[CityHall] 📩 Received log from car_5
[2025-06-28T14:39:11.373491][CityHall] 🔍 Prediction for car_5: DDoS-HOIC
[CityHall] 🚨 Malicious activity detected from car_5, broadcasting to zones...
[CityHall] 🔔 Notified zone_1@localhost about threat from car_5
[CityHall] 🔔 Notified zone_2@localhost about threat from car_5
[CityHall] 🔔 Notified zone_3@localhost about threat from car_5
[CityHall] 🔔 Notified zone_4@localhost about threat from car_5
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] 📩 Received log from car_1
[2025-06-28T14:39:37.383628][CityHall] 🔍 Prediction for car_1: Benign
[CityHall] ✅ Log from car_1 considered benign.
[CityHall] 📩 Received log from car_2
[2025-06-28T14:39:38.377798][CityHall] 🔍 Prediction for car_2: Benign
[CityHall] ✅ Log from car_2 considered benign.
[CityHall] 📩 Received log from car_3
[2025-06-28T14:39:39.371712][CityHall] 🔍 Prediction for car_3: Benign
[CityHall] ✅ Log from car_3 considered benign.
[CityHall] 📩 Received log from car_4
[2025-06-28T14:39:40.370233][CityHall] 🔍 Prediction for car_4: Benign
[CityHall] ✅ Log from car_4 considered benign.
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] 📩 Received log from car_1
[2025-06-28T14:39:52.374941][CityHall] 🔍 Prediction for car_1: Benign
[CityHall] ✅ Log from car_1 considered benign.
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] 📩 Received log from car_1
[2025-06-28T14:40:07.404851][CityHall] 🔍 Prediction for car_1: Benign
[CityHall] ✅ Log from car_1 considered benign.
[CityHall] 📩 Received log from car_2
[2025-06-28T14:40:08.370661][CityHall] 🔍 Prediction for car_2: Benign
[CityHall] ✅ Log from car_2 considered benign.
[CityHall] 📩 Received log from car_3
[2025-06-28T14:40:09.383531][CityHall] 🔍 Prediction for car_3: Benign
[CityHall] ✅ Log from car_3 considered benign.
[CityHall] 📩 Received log from car_4
[2025-06-28T14:40:10.374717][CityHall] 🔍 Prediction for car_4: Benign
[CityHall] ✅ Log from car_4 considered benign.
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] 📩 Received log from car_1
[2025-06-28T14:40:22.373185][CityHall] 🔍 Prediction for car_1: Benign
[CityHall] ✅ Log from car_1 considered benign.
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
[CityHall] ⏳ Waiting for car data...
^C[CityHall] 📩 Received log from car_1
[2025-06-28T14:40:37.374957][CityHall] 🔍 Prediction for car_1: Botnet
[CityHall] 🚨 Malicious activity detected from car_1, broadcasting to zones...
[CityHall] 🔔 Notified zone_1@localhost about threat from car_1
[CityHall] 🔔 Notified zone_2@localhost about threat from car_1
[CityHall] 🔔 Notified zone_3@localhost about threat from car_1
[CityHall] 🔔 Notified zone_4@localhost about threat from car_1
[CityHall] 📩 Received log from car_2
[2025-06-28T14:40:38.376635][CityHall] 🔍 Prediction for car_2: DDoS-MSSQL
[CityHall] 🚨 Malicious activity detected from car_2, broadcasting to zones...
[CityHall] 🔔 Notified zone_1@localhost about threat from car_2
[CityHall] 🔔 Notified zone_2@localhost about threat from car_2
[CityHall] 🔔 Notified zone_3@localhost about threat from car_2
[CityHall] 🔔 Notified zone_4@localhost about threat from car_2
^CTraceback (most recent call last):
  File "/usr/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 636, in run_until_complete
    self.run_forever()
  File "/usr/lib/python3.10/asyncio/base_events.py", line 603, in run_forever
    self._run_once()
  File "/usr/lib/python3.10/asyncio/base_events.py", line 1871, in _run_once
    event_list = self._selector.select(timeout)
  File "/usr/lib/python3.10/selectors.py", line 469, in select
    fd_event_list = self._selector.poll(timeout, max_ev)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/rafaelbranco/Documentos/ISEP/OmniWatch/ros2_ws/agents/cityHall.py", line 93, in <module>
    asyncio.run(main())
  File "/usr/lib/python3.10/asyncio/runners.py", line 47, in run
    _cancel_all_tasks(loop)
  File "/usr/lib/p